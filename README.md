# Генератор С++ тестов для измерения производительности С/С++ функций, описанных в формате Doxygen

## Что нужно для работы генератора

1. Описанные с помощью тегов Doxygen функции.
2. Сценарии производительности для каждой группы функций.
3. Шаблон сборки будущих тестов.
4. Тестируемые функции (в виде файлов с исходным кодом или библиотеки).



## Подготовка файлов с прототипами тестируемых функций

Все тестируемые функции должны быть описаны с помощью тегов Doxygen.
Использование doxygen-тега \defgroup обязательно.

## Подготовка сценария производительности

Чтобы создать сценарий производительности, нужно Doxygen-описание функции расширить специальными тегами.

Пример:

\xmlonly

        \<testperf>
	        \<param> src 		\</param> \<values>  im1 im2 \</values>
	        \<param> dst 		\</param> \<values>  im1 im2 \</values>
	        \<param> nSize 		\</param> \<values> 8 128 1024 \</values>
        \</testperf>
\endxmlonly

##### Описание тегов на основе примера

*\xmlonly* и *\endxmlonly* теги Doxygen для вставки xml-кода.

*\<testperf>* и *\</testperf>* xml-теги, которые ищет генератор для определения сценария производительности.

*\<param>* и *\</param>*  xml-теги для задания аргументов тестируемой функции.

*\<values>* и *\</values>* xml-теги для задания значений параметров функций. Функция будет протестирована с каждым из заданных значений.  

## Подготовка шаблона сборки будущего теста перед запуском генератора

Перед запуском генератора необходимо подготовить папку со следующим содержимым:
1. *Makefile*;
2. *Конфиг-файл (например: mc12101brd_nmpu0.cfg)*;
3. *main.cpp*.

##### Требования к Makefile

1. Необходимо убедиться, что *main.cpp* компилируется при вызове *make*.
2. *Makefile* должен подключать к компиляции *main.cpp* все файлы с исходным кодом тестируемых функций.

##### Требования к main.cpp

1. В *main.cpp* обязательно должны быть подключены заголовочные файлы: *time.h, stdio.h, stdlib.h*. 
2. Должны быть подключены заголовочные файлы, необходимые для работы тестируемой функции.
3. Должны быть описаны статические массивы. Их будут использовать тестируемые функции (названия массивов должны совпадать с названиями, указанными в сценарии производительности).
4. Должна быть создана главная функция *int main() { return 0; }*.


## Описание ключей для настройки работы скрипта

1. *--path\_to_inc* - путь к папке с файлами, в которых описаны функции в формате Doxygen.
__Этот параметр не имеет значения по умолчанию и должен быть задан обязательно.__

2. *--path\_to_build* - путь к папке, в которой должны лежать Makefile, конфиг-файл и шаблон main.cpp.
__Этот параметр не имеет значения по умолчанию и должен быть задан обязательно.__

3. *--path\_to_xml* - путь к папке, в которой лежат xml-файлы, полученные после работы Doxygen.
Значение по умолчанию: *<рабочая папка>\doxy\xml*

4. *--path\_to_tests* - путь к папке, в которой будет лежать папка(perf_tests) со сгенерированными тестами.
Значение по умолчанию: *<рабочая папка>*

5. *--path\_to_log* - путь к папке, в которой будет лежать папка(perf\_test\_log) с логами работы скрипта.
Значение по умолчанию: *<рабочая папка>*

6. *--point* - указывает скрипту для каких функций должны быть сгенерированны тесты (может быть равен *fixed* или *float*).
Значение по умолчанию: *float*

 *<рабочая папка>* - папка, из которой запускается скрипт

## Запуск
Для запуска скрипта на компьютере должен быть установлен python.

__Запуск скрипта осуществляется с помощью команды:__

*python gen\_xml\_and_tests.py*

При таком запуске скрипта, значения параметров скрипта будут выставлены по умолчанию.

__Запуск скрипта с параметрами:__

*python gen\_xml\_and\_tests.py --path\_to\_inc \<path> --path\_to\_build \<path>  --path\_to\_log \<path> --path\_to\_xml <path> --path\_to\_tests <path> --point \<fixed или  float>*

Порядок задания параметров скрипта не важен. Также не обязательно задавать все параметры. Незаданные параметры будут выставлены по умолчанию.

__Пример запуска скрипта:__

*python gen\_xml\_and\_tests.py --path\_to\_inc ../../include --path\_to\_build perf\make\_mc12101\_nmpu0*
